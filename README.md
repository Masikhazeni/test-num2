๐ฏ ูุนุฑู ูพุฑูฺู
<div style="font-size:40px;font-weight:600">ฺฉ ุณุณุชู ุชูุฒุนโุดุฏู ุจุฑุง ูพุฑุฏุงุฒุด ุฑูุฏุงุฏูุง ุจุง ูุนูุงุฑ ฺูุฏุณุฑูุณู ุดุงูู:</div>

API Gateway (Express.js)

Worker (ูพุฑุฏุงุฒุดฺฏุฑ ูพุงูโูุง)

Real-time Service (Socket.IO)

ูพุงฺฏุงูโูุง ุฏุงุฏู: 
PostgreSQL, MongoDB, Redis

ุตู ูพุงู:
RabbitMQ


๐๏ธ ุฑุงูโุงูุฏุงุฒ ุฏุณุช
 ูุตุจ ู ุฑุงูโุงูุฏุงุฒ ูพุงฺฏุงูโูุง ุฏุงุฏู:
 
 #ุฑุงูููุง ฺฏุงู ุจู ฺฏุงู ูุตุจ ู ุฑุงูโุงูุฏุงุฒ PostgreSQL ุฏุฑ ููุฏูุฒ:
 
 1.ุงุจุชุฏุง PostgreSQL ุฑุง ุฏุงูููุฏ ู ูุตุจ ฺฉูุฏ.


2.ูพุณ ุงุฒ ูุตุจ ฺฉุงููุ CMD ุฑุง ุจู ุนููุงู Administrator ุจุงุฒ ฺฉูุฏ ู ุฏุณุชูุฑุงุช ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:

cd C:\Program Files\PostgreSQL\14\bin

psql -U postgres -c "CREATE USER dp_user WITH PASSWORD '123456';"

psql -U postgres -c "CREATE DATABASE datapipeline OWNER dp_user;"

psql -U postgres -c "GRANT ALL PRIVILEGES ON DATABASE datapipeline TO dp_user;"

ูุฑุญูู 3: ุฑุงูโุงูุฏุงุฒ ุณุฑูุณ

sc query postgresql-x64-14

ุณูพุณ

net stop postgresql-x64-14

net start postgresql-x64-14

#ุฑุงูููุง ุฑุงู ุงูุฏุงุฒ Mongodb:

ูพุณ ุงุฒ ูุตุจ ู ุฑุงู ุงูุฏุงุฒ ูุฑู ุงูุฒุงุฑ ูุงุฑุฏ ุจุฑูุงูู ุดูุฏ :

ุฑู Create Database ฺฉูฺฉ ฺฉูุฏ

ูุงู ุฏุชุงุจุณ ุฑุง event-db ูุงุฑุฏ ฺฉูุฏ

ูุงู collection ุงูู ุฑุง ูโุชูุงูุฏ ุฎุงู ุจฺฏุฐุงุฑุฏ

Create ุฑุง ุจุฒูุฏ

ุจุฑุง ูุดุงูุฏู ุฏุชุงุจุณโูุง:

ุฏุฑ ุจุฎุด ูพุงู ูพูู ุณูุช ฺูพุ ูุณุช ุชูุงู ุฏุชุงุจุณโูุง ููุงุด ุฏุงุฏู ูโุดูุฏ
ุฏุฑ ุตูุญู ุงุตู ุงุชุตุงู:

ุฑู ุขฺฉูู </> ุฏุฑ ุจุงูุง ุตูุญู ฺฉูฺฉ ฺฉูุฏ

ุฑุดุชู ุงุชุตุงู ููุงุด ุฏุงุฏู ูโุดูุฏ

ุขู ุฑุง ฺฉูพ ฺฉูุฏ.
ูพุณ ุงุฒ ุชุณุช ุงุชุตุงู ูููู

ุฑู Save Connection ฺฉูฺฉ ฺฉูุฏ

ูุงู ุจุฑุง ุงู ุงุชุตุงู ุงูุชุฎุงุจ ฺฉูุฏ (ูุซูุง Local Event DB)
ุณูพุณ ุฏุฑ ฺฉุฏ ุฎูุฏ ุจุฑุง ุงุชุตุงู ุงุฒ url ฺฉูพ ุดุฏู ุงุณุชูุงุฏู ฺฉูุฏ(ูุซุงู ุงุณุชูุงุฏู ุฏุฑ ฺฉุฏ ูุง ุฏุฑ ูุณูุช connectMongo.js ููุฌูุฏ ุงุณุช)

#ุฑุงูููุง  ุฑุงู ุงูุฏุงุฒ RabittMQ:

1.ูพุดโูุงุฒูุง (ูุตุจ Erlang)
2.ูุตุจ RabbitMQ

ุงุฒ ููู Startุ RabbitMQ Command Prompt ุฑุง ุจู ุนููุงู Administrator ุงุฌุฑุง ฺฉูุฏ

ุฏุณุชูุฑุงุช ุฒุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ:
rabbitmq-plugins enable rabbitmq_management

rabbitmq-service start

ุฏุณุชุฑุณ ุจู ูพูู ูุฏุฑุช:

ูุฑูุฑฺฏุฑ ุฎูุฏ ุฑุง ุจุงุฒ ฺฉูุฏ ู ุจู ุขุฏุฑุณ ุฒุฑ ุจุฑูุฏ:


http://localhost:15672
ุจุง ุงุทูุงุนุงุช ูพุดโูุฑุถ ูุงุฑุฏ ุดูุฏ:

Username: guest

Password: guest

ูพุณ ุงุฒ ุฑุงู ุงูุฏุงุฒ ูุชูุงูุฏ ูุทุงุจู ฺฉุฏ ูุง ููุฌูุฏ ุฏุฑ  rabittmq.js ู ูููุทูุฑ ุฏุฑ ูพูุดู service ุตูุญู queue.js ูุดุงูุฏู ฺฉูุฏ.
ุงูู ฺฉุงูฺฉุดู ุจุฑูุฑุงุฑ ูโุดูุฏ

ุณูพุณ ฺฉุงูุงู ุณุงุฎุชู ูโุดูุฏ

ุตู ุชุนุฑู ูโุดูุฏ (ุงฺฏุฑ ุงุฒ ูุจู ูุจุงุดุฏ)

ุงุฑุณุงู ู ุฏุฑุงูุช ุดุฑูุน ูโุดูุฏ

#ุฑุงูููุง ุฑุงู ุงูุฏุงุฒ Redis:

1.ุฏุงูููุฏ Redis 

2.ูุตุจ ูฺฉูู

3.ุฏฺฉูู Win + R ุฑู ุจุฒูุ ุชุงูพ ฺฉู:services.msc

4.ุงูุชุฑ ุจุฒู ู ุฏูุจุงู Redis ุจฺฏุฑุฏ

5.ูุทูุฆู ุดู ฺฉู ูุถุนุชุด ุฑู Running ูุณุช

6ุญุงูุง Command Prompt (ุชุฑุฌุญุงู "Run as Administrator") ุฑู ุจุงุฒ ฺฉู:

ุชุงูพ ฺฉู:redis-cli

ุญุงูุง Redis CLI ุจุงุฒ ูโุดู. ุจุฑุง ุชุณุช

set mykey "salam"
get mykey

 ุงฺฏุฑ ุฌูุงุจ ุจุฑฺฏุดุช ู ุจู ุฏุฑุณุช ฺฉุงุฑ ูฺฉูู.


ุฏุฑ ูุงู .env (ุง config.env) ูพุฑูฺูุ ุขุฏุฑุณ Redis ุจู ุดฺฉู ุฒุฑ ุชูุธู ุดุฏู:REDIS_URL=redis://localhost:6379

ุงุณุชูุงุฏู ุฏุฑ ูพุฑูฺู:

ููฺฏุงู ุซุจุช ุฑูุฏุงุฏ ุฌุฏุฏุ ูพุณ ุงุฒ ุฐุฎุฑู ุฏุฑ ูพุงฺฏุงูโุฏุงุฏูโูุงุ ุฏุงุฏูโูุง ุฏุฑ Redis cache ูโุดููุฏ.

ุฏุฑ ููฺฏุงู ุฏุฑุงูุช ุงุทูุงุนุงุช (GET)ุ
ุงุจุชุฏุง Redis ุจุฑุฑุณ ูโุดูุฏ ุชุง ุงุฒ ฺฉุด ุฎูุงูุฏู ุดูุฏ ู ุฏุฑ ุตูุฑุช ูุจูุฏุ ุงุฒ ุฏุชุงุจุณ ุฎูุงูุฏู ุดุฏู ู ุฏุฑ Redis ุฐุฎุฑู ูโุดูุฏ.(ฺฉุฏ ูุฑุจูุทู ุฑุง ูุชูุงูุฏ ุฏุฑ ูุณูุช  controllers/eventControllers.js ูุดุงูุฏู ฺฉูุฏ)

ููฺูู Redis ุจุฑุง ุงูุชุดุงุฑ ุฑูุฏุงุฏูุง ุฌุฏุฏ ุจู ฺฉูุงูุชโูุง ูุชุตู ุงุฒ ุทุฑู WebSocket ุงุณุชูุงุฏู ูโุดูุฏ (Pub/Sub).

ุงุณุชูุงุฏู ุนูู ุฏุฑ ฺฉุฏ ูุง ุฏุฑ ูุงู config ุฏุฑูุณูุชconnectRedis.js ู ูููุทูุฑ ุฏุฑ ูุณูุช worker ุฌูุช ุซุจุช ู ูพุงุจูุด ฺฉุฑุฏู ุฏุงุฏู ูุง ู ุฏุฑ ูุณูุช server.js ุฌูุช ุงุฑุณุงู ุงุฒ ุทุฑู socket ูุงู ูุดุงูุฏู ุงุณุชุุถููุง ุฑูุงุจุท ูุฑุจูุท ุจู cachingุฏุฑ ูุงู services ูุณูุช cacheService.js ููุดุชู ุดุฏู ุงุณุช.


#ูุนูุงุฑ ฺฉู ุณุณุชู:
๐ API Gateway (Express.js)
ูุธูู: ุฏุฑุงูุช ุฏุฑุฎูุงุณุชโูุง REST ุงุฒ ฺฉุงุฑุจุฑ

ฺฉุงุฑุจุฑุฏ ุงุตู:

ุงุนุชุจุงุฑุณูุฌ ุฏุงุฏูโูุง ูุฑูุฏ

ุงุฑุณุงู ุฑูุฏุงุฏูุง ุจู ุตู RabbitMQ

ูพุงุณุฎ ููุฑ ุจู ฺฉุงุฑุจุฑ (ุจุฏูู ุงูุชุธุงุฑ ุจุฑุง ูพุฑุฏุงุฒุด)

ูพูุฑุช: 5000

๐ Worker Service (Consumer)
ูุธูู: ูพุฑุฏุงุฒุด ููุงุฒ ุฑูุฏุงุฏูุง

ูุฑุงุญู ูพุฑุฏุงุฒุด:
ูุง ุฏุฑ ุงุจุชุฏุง ุจุง ุณุงุฎุชู ุฌุฏูู ูุง devices , usersฺฉ ุงุฒ ุทุฑู ูุฒุฑ ุงุฏ ุจู ฺฉุฏฺฏุฑ ูุฑุชุจุท ูุณุชูุฏุุชุนุฏุงุฏ ุฏุณุชฺฏุงู ู ฺฉุงุฑุจุฑ ุฌูุช ุชุณุช ุฏุฑ postgreSQLุซุจุช ฺฉุฑุฏู ุงู ู ุฏุฑ ุงุฏุงูู ุจุง ูพุฑุฏุงุฒุด ุฏุงุฏู ู ุงุณุชูุงุฏู ุงุฒ ุงุทูุงุนุงุช ุฌุฏุงูู ุงุฏุงูู ูุฏูู.

ุฏุฑุงูุช ูพุงู ุงุฒ RabbitMQ

ุฐุฎุฑู ุณูุฏ ุฏุฑ MongoDB

ุขูพุฏุช Redis Cache

ุงูุชุดุงุฑ ุฑูุฏุงุฏ ุจุฑุง Real-time Service Real-time Service (Socket.IO)

ูุธูู: ุงุฑุณุงู ูุญุธูโุง ุจู ฺฉุงุฑุจุฑุงู

ูฺฉุงูุณู:

ฺฏูุด ุฏุงุฏู ุจู ฺฉุงูุงู Redis (Pub/Sub)

ุงุฑุณุงู ุฏุงุฏู ุงุฒ ุทุฑู WebSocket


#ุฑุงูโุงูุฏุงุฒ ุณุฑูุณโูุง (ุฏุฑ ุฏู ุชุฑููุงู ุฌุฏุงฺฏุงูู):

ุฏุฑ ุชุฑููุงู ุงูู : npm run dev

ุฏุฑ ุชุฑููุงู ุฏูู:npm run consumer

ุฌูุช ุงุฑุณุงู ุฏุงุฏู ู ุชุณุช ูุชูุงูุฏ ุงุฒ POST http://localhost:5000/api/events ุงุณุชูุงุฏู ฺฉูุฏ.

#ุชุณุช:

ุจุฑุง ูุณูุช worker(processMessage) ุจุง ุงุณุชูุงุฏู ุงุฒ Mocha/Chai ุชุณุช ููุณ ุจุฑ ููุง unit test ุงูุฌุงู ุดุฏู ฺฉ ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉุฏ npm run test:worker ุฏุฑ ุชุฑููุงู ูุชุงุฌ ูุงุจู ูุดุงูุฏู ุฎูุงูุฏ ุจูุฏ.ุจุฑุง ุฑุงู ุงูุฏุงุฒ ุงู ุณุณุชู ุงุจุชุฏุง ฺฉุฏ ุฏุฑ ูุงู servises ุตูุญู messageProcessor ุฑุง ุทุฑุงุญ ฺฉุฑุฏู ุฌูุช ุฌุฏุง ฺฉุฑุฏู ููุทู ุฎุงูุต (Pure Logic) ุงุฒ ูุงุจุณุชฺฏโูุง ุฌุงูุจ ูุซู RabbitMQุ Redisุ ุง MongoDB.

ุจุฑุง ูุณูุช API Gatawayุ integration test ุทุฑุงุญ ุดุฏู ฺฉ ุจุง ฺฉุฏ ุฏุณุชูุฑ npm test ุฑุงู ุงูุฏุงุฒ ุดุฏู ู ูุงุจู ูุดุงูุฏู ุงุณุช.ุฌูุช ุฑุงู ุงูุฏุงุฒ ุงู ูุณูุช ฺฉ database ุฌูุช ุชุณุช ุฏุฑ Mongodb , postgreSQL ุณุงุฎุชู ุดุฏู ฺฉู ุฏุฑ ูุงู .env.test ุงุทูุงุนุงุช ูุฑุจูุท ุจู ุงู ููุงุฑุฏ ูุฑุงุฑุฏุงุฏู ุดุฏู ุงุณุช. 








